L.StreetLabels=L.LabelTextCollision.extend({options:{propertyName:"name",showLabelIf:null,fontStyle:{dynamicFontSize:!1,fontSize:10,fontSizeUnit:"px",lineWidth:4,fillStyle:"black",strokeStyle:"white"}},initialize:function(t){L.LabelTextCollision.prototype.initialize.call(this,t),L.Util.stamp(this),this._layers=this._layers||{}},_initContainer:function(t){if(L.LabelTextCollision.prototype._initContainer.call(this,t),this._map){var e=function(){this._reset(),this._redraw()}.bind(this);this._map.on("layerremove",L.Util.throttle(e,32,this))}},_text:function(o,t){if(t&&t.feature&&t.feature.properties&&"undefined"!==t.feature.properties[this.options.propertyName]){if(this.options.showLabelIf&&!1===this.options.showLabelIf.call(this,t.feature))return;var e,s=t.feature.properties[this.options.propertyName];if(o.globalAlpha=1,0===t._parts.length||0===t._parts[0].length)return;if(!(e=t instanceof L.Polygon&&this._map.hasLayer(t)?this._getCentroid(t):this._getCenter(t._parts[0])))return;o.lineWidth=this.options.fontStyle.lineWidth;var i=this.options.fontStyle.fontSize;this._map&&!0===this.options.fontStyle.dynamicFontSize&&(i=this._getDynamicFontSize()),o.font=i+this.options.fontStyle.fontSizeUnit+" 'Helvetica Neue',Helvetica,Arial,sans-serif";var n=o.measureText(s).width+e.x,r=e.y+0+20,a=L.bounds(L.point(e.x+0,e.y+0),L.point(n,r));if(this.options.collisionFlg)for(var l in this._textList){if(this._textList[l].intersects(a))return}if(this._textList.push(a),o.fillStyle=this.options.fontStyle.fillStyle,o.strokeStyle=this.options.fontStyle.strokeStyle,t instanceof L.Polygon||t instanceof L.CircleMarker){var h=o.measureText(s).width;o.strokeText(s,e.x+0-h/2,e.y+0),o.fillText(s,e.x+0-h/2,e.y+0)}t instanceof L.Polyline&&t._parts&&(o.textAlign="center",o.textBaseline="middle",o.lineWidth=3,t._parts.forEach(function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];e.push(n.x),e.push(n.y)}o.textPath(s,e)}))}},_getDynamicFontSize:function(){return parseInt(this._map.getZoom())},_getCentroid:function(t){if(t&&t.getCenter&&this._map){var e=t.getCenter(),i=this._map.latLngToContainerPoint(e);return this._map.containerPointToLayerPoint(i)}}});